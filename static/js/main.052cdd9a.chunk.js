(this["webpackJsonpschedule-ts"]=this["webpackJsonpschedule-ts"]||[]).push([[0],{169:function(e,t,r){e.exports=r(268)},248:function(e,t,r){},268:function(e,t,r){"use strict";r.r(t);r(170),r(197),r(199),r(200),r(202),r(203),r(204),r(205),r(206),r(207),r(208),r(209),r(211),r(212),r(213),r(214),r(215),r(216),r(217),r(218),r(219),r(220),r(222),r(223),r(224),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(232),r(233),r(234),r(235),r(236),r(237),r(238),r(239);var n=r(0),a=r.n(n),c=r(43),u=r.n(c),s=r(25),o=r.n(s),i=(r(247),r(248),r(12)),d=r(26),l={story:"profile",panels:{schedule:"search",profile:"profile",list:"list"}},p=Object(i.c)({name:"navigation",initialState:l,reducers:{changeStory:function(e,t){e.story=t.payload},changePanel:function(e,t){var r=t.payload,n=r.story,a=r.panel;"schedule"===n?e.panels.schedule=a:"profile"===n&&(e.panels.profile=a)}}}),f=p.actions,h=(f.changeStory,f.changePanel,p.reducer),m=Object(i.c)({name:"search",initialState:{query:"",loading:!1},reducers:{setQuery:function(e,t){e.query=t.payload},setLoading:function(e,t){e.loading=t.payload}}}),g=m.actions,b=(g.setQuery,g.setLoading,m.reducer),y=r(6),v=r.n(y),w=r(11),k="https://schedule-vk-mini-app.herokuapp.com",j=function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.replace(/(\?|&)/g,"").replace("=","/"),n="".concat(k,"/schedule/").concat(r),e.next=4,fetch(n);case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(k,"/user/").concat(t),e.next=3,fetch(r);case 3:return n=e.sent,e.abrupt("return",n.json());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(k,"/user/").concat(t),n={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"}},e.next=4,fetch(r,n);case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n,a,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uid,n=t.group,a="".concat(k,"/user/group"),c={method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({uid:r,group:n})},e.next=5,fetch(a,c);case 5:return u=e.sent,e.abrupt("return",u.json());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U={requestSchedule:j,requestUser:x,delGroup:function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="".concat(k,"/user/group"),n={method:"DELETE",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({uid:t})},e.next=4,fetch(r,n);case 4:return a=e.sent,e.abrupt("return",a.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),registerUser:S,addGroup:O,getStreams:function(){var e=Object(w.a)(v.a.mark((function e(){var t,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(k,"/streams"),e.next=3,fetch(t);case 3:return r=e.sent,e.abrupt("return",r.json());case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},E=r(15),C=r(39),D=function(){var e=new Date,t=e.getTime(),r=e.getDay(),n=C.filter((function(e){var r=Object(E.a)(e.date,2),n=r[0],a=r[1];return n<=t&&t<=a}))[0].week;return 0!==r?n:0===n?1:0},q=(r(61),r(93),Object(i.b)("schedule/request",function(){var e=Object(w.a)(v.a.mark((function e(t,r){var n,a,c,u;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.href,a=r.getState().schedule.schedules,!(c=a.find((function(e){return e.href===n.replace("&","")})))){e.next=5;break}return e.abrupt("return",{uniq:!1,schedule:c});case 5:return e.next=7,U.requestSchedule(n);case 7:return u=e.sent,e.abrupt("return",{uniq:!0,schedule:u});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}())),M={activeMode:{text:"\u041f\u043e \u0434\u043d\u044f\u043c",id:"byDays"},isDiff:!1,day:function(){var e=(new Date).getDay();return e>0?e-1:e}(),week:D(),activeSubject:null,loading:!1,error:!1,activeSchedule:null,schedules:[],history:[]},T=Object(i.c)({name:"schedule",initialState:M,reducers:{changeMode:function(e,t){e.activeMode=t.payload},changeDay:function(e,t){e.day=t.payload},changeWeek:function(e,t){e.week=t.payload},setSubject:function(e,t){e.activeSubject=t.payload},setIsDiff:function(e,t){e.isDiff=t.payload},popHistory:function(e){if(e.isDiff=!1,e.history.pop(),0!==e.history.length){var t=e.history[e.history.length-1],r=e.schedules.find((function(e){return e.href===t}));r.exams||"exams"!==e.activeMode.id||(e.activeMode=M.activeMode),e.activeSchedule=r}},clearHistory:function(e){e.history=[],e.isDiff=!1}},extraReducers:function(e){e.addCase(q.pending,(function(e,t){e.loading=!0,e.error=!1,e.activeSchedule=null;var r=t.meta.arg,n=r.add,a=void 0===n||n,c=r.href;a&&e.history.push(c.replace("&",""))})).addCase(q.rejected,(function(e){e.loading=!1,e.error=!0,e.isDiff=!1})).addCase(q.fulfilled,(function(e,t){e.loading=!1,e.error=!1;var r=t.payload,n=r.uniq,a=r.schedule;e.activeSchedule=a,n&&e.schedules.push(a),a.exams||"exams"!==e.activeMode.id||(e.activeMode=M.activeMode)}))}}),W=T.actions,G=(W.changeMode,W.changeDay,W.changeWeek,W.setSubject,W.popHistory,W.setIsDiff,W.clearHistory,T.reducer),I=Object(i.b)("streams/request",U.getStreams),J=Object(i.b)("user/request",function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.requestUser(t);case 2:if(!(r=e.sent)){e.next=5;break}return e.abrupt("return",r);case 5:return e.next=7,U.registerUser(t);case 7:return n=e.sent,e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),H=Object(i.b)("group/add",function(){var e=Object(w.a)(v.a.mark((function e(t){var r,n,a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.uid,n=t.group,e.next=3,U.addGroup({uid:r,group:n});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),P=Object(i.b)("group/del",function(){var e=Object(w.a)(v.a.mark((function e(t){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.delGroup(t);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),N=Object(i.c)({name:"profile",initialState:{loadingStreams:!1,errorStreams:!1,streams:[],user:null,userId:null,loadingUser:!0,errorUser:!1},reducers:{},extraReducers:function(e){e.addCase(J.pending,(function(e,t){e.loadingUser=!0,e.errorUser=!1,e.userId=t.meta.arg})).addCase(J.rejected,(function(e){e.loadingUser=!1,e.errorUser=!0})).addCase(J.fulfilled,(function(e,t){e.loadingUser=!1,e.errorUser=!1,e.user=t.payload})).addCase(H.pending,(function(e){e.loadingUser=!0,e.errorUser=!1})).addCase(H.rejected,(function(e){e.loadingUser=!1,e.errorUser=!0})).addCase(H.fulfilled,(function(e,t){e.loadingUser=!1,e.errorUser=!1,e.user.group=t.payload.group,e.user.myGroup=t.payload.myGroup,e.user.fromWhoms=t.payload.fromWhoms})).addCase(P.pending,(function(e){e.loadingUser=!0,e.errorUser=!1})).addCase(P.rejected,(function(e){e.loadingUser=!1,e.errorUser=!0})).addCase(P.fulfilled,(function(e){e.loadingUser=!1,e.errorUser=!1,e.user.group="",e.user.myGroup=null,e.user.fromWhoms=[]})).addCase(I.pending,(function(e){e.loadingStreams=!0,e.errorStreams=!1})).addCase(I.rejected,(function(e){e.loadingStreams=!1,e.errorStreams=!0})).addCase(I.fulfilled,(function(e,t){e.loadingStreams=!1,e.errorStreams=!1,e.streams=t.payload}))}}).reducer,A=Object(d.b)({navigation:h,search:b,schedule:G,profile:N}),L=Object(i.a)({reducer:A}),V=r(92),K=r(22),Q=function(){return a.a.createElement(K.a,{isWebView:!0},a.a.createElement(K.e,{activePanel:"panel"},a.a.createElement(K.c,{id:"panel"},a.a.createElement(K.d,{stretched:!0,action:a.a.createElement(K.b,{href:"https://vk.com/app7908078"},"\u041d\u043e\u0432\u044b\u0439 \u0430\u0434\u0440\u0435\u0441")},"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u0438\u043b\u043e\u0441\u044c \u0438 \u0440\u0430\u0441\u043f\u043e\u043b\u0430\u0433\u0430\u0435\u0442\u0441\u044f \u043f\u043e-\u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0430\u0434\u0440\u0435\u0441\u0443"))))},R=r(90),B=r(91),F=r.n(B),z=function(e){return Object(R.a)(e),a.a.createElement(K.d,{icon:a.a.createElement(F.a,{width:56,height:56}),action:a.a.createElement(a.a.Fragment,null,a.a.createElement(K.b,{href:"http://www.bstu.ru/about/useful/schedule"},"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435"),a.a.createElement("br",null),a.a.createElement("br",null),a.a.createElement(K.b,{href:"https://vk.com/club198278031"},"\u0413\u0440\u0443\u043f\u043f\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f")),stretched:!0},"\u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043e\u0442\u0434\u044b\u0445\u0430\u0435\u0442",a.a.createElement("br",null)," \u0441 23:00 \u0434\u043e 07:00 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0434\u043d\u044f")},X=function(){var e=(new Date).getUTCHours();return e>=20||e<4?a.a.createElement(z,null):a.a.createElement(V.a,{store:L},a.a.createElement(Q,null))};o.a.send("VKWebAppInit"),o.a.subscribe((function(e){"VKWebAppUpdateConfig"===e.detail.type&&document.body.setAttribute("scheme",e.detail.data.scheme)})),u.a.render(a.a.createElement(X,null),document.getElementById("root"))},39:function(e){e.exports=JSON.parse('[{"date":[1621198800000,1621803540000],"week":1},{"date":[1621803600000,1622408340000],"week":0},{"date":[1622408340000,1630443600000],"week":1}]')},61:function(e){e.exports=JSON.parse('[{"date":[1611522000000,1612126799000],"week":1},{"date":[1612126800000,1612731599000],"week":0},{"date":[1612731600000,1613336399000],"week":1},{"date":[1613336400000,1613941199000],"week":0},{"date":[1613941200000,1614545999000],"week":1},{"date":[1614546000000,1615150799000],"week":0},{"date":[1615150800000,1615755599000],"week":1},{"date":[1615755600000,1616360399000],"week":0},{"date":[1616360400000,1616965199000],"week":1},{"date":[1616965200000,1617569999000],"week":0},{"date":[1617570000000,1618174799000],"week":1},{"date":[1618174800000,1618779599000],"week":0},{"date":[1618779600000,1619384399000],"week":1},{"date":[1619384400000,1619989199000],"week":0},{"date":[1619989200000,1620593999000],"week":1},{"date":[1620594000000,1621198799000],"week":0},{"date":[1621198800000,1621803599000],"week":1},{"date":[1621803600000,1622408399000],"week":0}]')}},[[169,1,2]]]);
//# sourceMappingURL=main.052cdd9a.chunk.js.map